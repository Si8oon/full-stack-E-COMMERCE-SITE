{% extends "base.html" %}
{% block title %}Products - NiA Store{% endblock %}

{% block content %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/products.css') }}">

<main class="store">
  <!-- Filter bar -->
  <section class="filter-bar">
    <input type="text" id="searchInput" placeholder="Search products..." />
    <select id="categoryFilter">
      <option value="all">All</option>
      <option value="sneakers">Sneakers ðŸ‘Ÿ</option>
      <option value="shirts">Shirts ðŸ‘•</option>
      <option value="trousers">Trousers ðŸ‘–</option>
      <option value="shorts">Shorts ðŸ©³</option>
    </select>
  </section>

  <!-- Product grid -->
  <section class="grid all-products">
    {% for item in products %}
      <div class="card" 
           data-name="{{ item.name|lower }}" 
           data-category="{{ item.category|lower }}">
        
        <!-- Image with hover effect -->
        <div class="card-image">
          <img src="{{ url_for('static', filename=item.image) }}" alt="{{ item.name }}">
        </div>

        <!-- Card content -->
        <div class="card-content">
          <span class="category-badge">{{ item.category }}</span>
          <h3 class="product-title">{{ item.name }}</h3>
          <p class="price">â‚µ{{ "%.2f"|format(item.price) }}</p>
          
          <a href="{{ url_for('add_to_cart', product_id=item.id) }}" class="add-to-cart-btn">
            <span class="btn-icon">ðŸ›’</span>
            Add to Cart
          </a>
        </div>
      </div>
    {% endfor %}
  </section>
</main>

<script>
  // Simple product filtering
  const searchInput = document.getElementById("searchInput");
  const categoryFilter = document.getElementById("categoryFilter");
  const cards = document.querySelectorAll(".card");

  function filterProducts() {
    const search = searchInput.value.toLowerCase();
    const category = categoryFilter.value;

    cards.forEach(card => {
      const name = card.dataset.name;
      const cat = card.dataset.category;

      const matchSearch = name.includes(search);
      const matchCategory = (category === "all" || cat === category);

      card.style.display = matchSearch && matchCategory ? "block" : "none";
    });
  }

  // Add smooth animation when filtering
  function smoothFilter() {
    cards.forEach(card => {
      card.style.opacity = "0.5";
      card.style.transform = "scale(0.95)";
    });

    setTimeout(() => {
      filterProducts();
      
      cards.forEach(card => {
        if (card.style.display !== "none") {
          card.style.opacity = "1";
          card.style.transform = "scale(1)";
        }
      });
    }, 200);
  }

  // Add button click animation
  document.addEventListener('click', function(e) {
    if (e.target.classList.contains('add-to-cart-btn')) {
      e.target.style.transform = 'scale(0.95)';
      setTimeout(() => {
        e.target.style.transform = 'scale(1)';
      }, 150);
    }
  });

  // Event listeners
  searchInput.addEventListener("input", smoothFilter);
  categoryFilter.addEventListener("change", smoothFilter);
</script>
{% endblock %}